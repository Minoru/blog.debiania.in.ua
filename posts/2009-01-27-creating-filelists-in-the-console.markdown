---
title: Создание списков файлов в консоли
published: 2009-01-27T17:41:00Z
categories: 
tags: tips'n'tricks
description: find и немного магии sed.
---

Не раз мне приходилось сталкиваться с задачей сделать список файлов, расположенных в данной директории и её поддиректориях. Каждый раз я находил какое-то решение, но к следующему возникновению аналогичной задачи оно забывалось. В общем, сегодня я решил записать свою уловку — может быть, пригодится не мне одному.

Сначала я, если позволите, пущусь в небольшое рассуждение на тему «зачем это надо». Итак,

<b><font size="+1">Зачем это надо?</font></b>

Данная уловка пригодится в следующих случаях:<ul><li>нужно сделать список всего аниме, которые есть у тебя на винчестере — например, чтобы переслать по джабберу друзьям, которые не знают, чего посмотреть, и просят у тебя какую-нибудь анимешку;</li><li>сделать «плейлист» манги, которую читаешь; для непосвящённых объясню — сканы манги обычно распространяются в виде изображений, сложенных в директории по главам, а главы, в свою очередь, группируются по томам. Как раз для такого применения уловка и придумана — такие «плейлисты» очень удобно скармливать <code>feh</code>'у, используя опцию <code>-f</code></li><li>ещё тысяча и один случай, пока что не придуманы :D</li></ul>
Собственно сама уловка:
```
find -type f -print
```
Легко, правда? :) По вкусу можно добавить такие вот примочки:
```
find -type f -print | sort
```
отсортирует список по возрастанию (особенно полезно при создании «плейлиста» манги — <code>feh -r ./*</code> имеет обыкновение путать изображения).

И ещё одно дополнение, ради которого, собственно говоря, и писался данный пост:
```
curdir=$(pwd | sed 's/\//\\\//g') && \
find -type f -print | sort | sed "s/./$curdir/"
```
Соль конструкции в том, что вместо относительных путей в плейлисте будут абсолютные — т.е. его можно будет запустить из любой директории, а не только из той, в которой он был создан.

Напоследок маленький совет: если собираетесь использовать эту команду широко, то создайте скрипт следующего содержания:
```
#!/bin/bash
curdir=$(pwd | sed 's/\//\\\//g') && \
find -type f -print | sort | sed "s/./$curdir/"
```
сохраните его в <code>/usr/bin</code> под каким-нибудь понятным именем (<code>mkfilelist</code>, к примеру), установите бит исполняемости (<code>mode +x mkfilelist</code>) и используйте на здоровье. А лучше поступите так, как я [советовал ранее](/posts/2008-08-29-making-life-easier-integrating-bash-scripts-into-the-system.html), и не засоряйте системные каталоги.

Удачи!
