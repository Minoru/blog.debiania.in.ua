---
title: "ICFPC 2020: итоги и выводы"
language: russian
description: # No double quotes; end with a period
tags: icfpc, programming
---

Это шестая, заключительная часть моей серии отчётов об ICFPC 2020. Остальные
части ищите здесь:

1. [предисловие][icfpc-2020-part-1];
2. [день первый][icfpc-2020-part-2];
3. [день второй][icfpc-2020-part-3];
4. [день третий][icfpc-2020-part-4];
5. [день четвёртый][icfpc-2020-part-5];
6. итоги и выводы (это то, что вы сейчас читаете).

<hr/>

[Мы заняли 38-е место из 95-и][pre-final-scoreboard], при этом 30 команд не
заработали ни единого балла. Я удивлён, что мы не оказались среди их числа.

# О задании

Делать тизеры частью задания нельзя. ICFPC длится 72 часа, а не две недели. Те,
кто вникал в тизеры, в час T просто нажали F5 на ReadTheDocs и продолжили
то, что делали предыдущие 14 дней. Формально это давало некоторым командам
преимущество.

Дальше. [Правила соревнования][rules][^1], пункт 2, гласят (выделение моё):

> […] **Teams may not** divide, merge, or **collaborate** after the start of the
> contest.

Вопреки этому соревнование началось именно с призыва собраться в Discord
и сообща разгадывать сообщения. Первые сутки мы не могли делать *ничего
другого*, кроме как коллаборироваться. Соревнование как таковое началось [только
спустя 24 часа 45 минут][how-to-win].

«Космолисп» и galaxy.txt оказались просто большим сайд-квестом. Да, там были
туториалы, способные помочь с основной задачей, но с тем же успехом мы,
наверное, могли проспать первые 46 часов, а после [публикации описания
команд][protocol] зависнуть в Discord и таким образом выяснить всё, чего не
знали.

За «космолисп» обидно вдвойне: вещь красивая, но программировать на нём довелось
только при написании тестов.

Задание было, фактически, «матрёшкой» из загадок, а ядром её оказалось довольно
скучная задача по управлению космофлотом. Да, там была неожиданная метрика
расстояний и странная гравитация, но интереса задаче придавали *исключительно*
загадки, в которые она была спрятана.

Я думаю, что понимаю исходные организаторов: сеттинг, загадки, «матрёшечность»
задания, финальное видео — всё это складывается во вполне стройный набор идей
и предпосылок. Озвученные выше огрехи допущены вовсе не по расхлябанности; они
являются прямым следствием попытки сделать уникальный контест.

Как я уже писал, ICFPC похож на жизнь, но у него есть одно ключевое отличие:
какая бы ни творилась дичь, насколько плохо не шли бы дела команды, я абсолютно
точно знаю дату и время, когда всё это закончится. Это даёт организаторам
некоторый карт-бланш, и в этом году им воспользовались по максимуму.

«Контур», не знаю, читает ли кто-то из вас этот отчёт, но: вы провели
действительно выдающийся ICFPC, и я снимаю перед вами шляпу. ❤️

# Об организации соревнования

Вместо финального зачёта было восемь мини-контестов длиной от двух до
восемнадцати часов. Чтобы выиграть, нужно было хорошо выступить *во всех*.
Фактически это гарантирует, что команды выкатят в продакшен первый работающий
прототип, и в дальнейшем будут допиливать *его*, а не исследовать альтернативы.
Мне это кажется бессмысленным ограничением, я не понимаю, зачем так сделано.

Созданный организаторами антураж — бесподобен. Для приостановки неверия
достаточно было не читать никаких новостей, кроме блога Ивана Зайцева.

Техническая часть также была сделана отменно. Самое страшное, с чем
я столкнулся — это периодически отваливающиеся websocket-ы. Всё остальное
работало просто превосходно: билды за разумное время, нормально обновляющийся
лидерборд, никаких проблем с визуализатором и прочей инфраструктурой. Не
исключаю, что в конце соревнования мне только *казалось*, что билды стали чуть
медленнее.

# О командной работе

Чтобы решить много загадок и проверить много идей, нужно много светлых голов
и вдвое больше рук. Пожалуй, моим основным вкладом в нынешний результат было
приглашение IngvarJackal-а и pink-snow к нам в команду: именно они написали
львиную долю того кода, что завоевал нам 38-е место.

Даже самым светлым головам нужна организация труда, будь то менеджер, вики
знаний, или же расписание статус-митингов. Для команды из восьми человек чат уже
не может использоваться для хранения знаний — слишком большой объём и слишком
мало структуры. Без должной координации часть потенциала участников останется
неиспользованной; так, мне кажется, случилось в этом году с mr146, unclechu
и Akon32 — любые поставленные задачи они решали быстро, да вот списка задач
у нас не было, и часть времени была потеряна впустую.

Когда программист переключается с «не-своего» на «свой» язык, разница
в производительности поражает. Из-за этого [Форневер подумывает][fvnever-report]
в будущих контестах объединять языки через IPC, чтобы каждый писал на чём ему
удобно. Также напрашивается идея разделиться на мелкие «одноязыковые» команды,
но я так не хочу.

Самоуверенность убивает. Я пресёк две попытки превратить функцию `reduce`
в полноценную «вычислялку» «космолиспа» и, таким образом, задержал прогресс
команды на целые сутки.

Самоуверенность убивает, часть вторая: если сокомандник что-то пишет в чат —
прислушайся! При перечитывании лога мне в глаза постоянно бросались «голоса
разума»: «пора делать это», «нужно сконцентрироваться на том». В пылу контеста
эти сообщения легко воспринять просто как очередной TODO, коих и так десяток на
человека, но с этим импульсом необходимо бороться.

Когда мы играли впятером, разного рода «вспомогательные программы»
и «прототипы», не находя поддержки команды, отмирали сами собой. В этом же году
у нас оказалось достаточно рук, чтобы выполнить одну и ту же работу *трижды*, на
трёх разных языках. Результат неоднозначен: с одной стороны, только благодаря
такой свободе мы попали в лидерборд; с другой, обилие несовместимых реализаций
демотивирует команду и создаёт трения. Я хочу продолжать играть с этими людьми,
поэтому в будущих контестах буду сопротивляться повторению этой ошибки даже
в ущерб производительности.

Приглашаешь людей — подумай, как будешь координировать их работу. Взялся
координировать — считай это своей основной деятельностью, а не «так-то
я программист, просто пару раз в день ещё и переклички делаю».

<div class="center">
<img src="/images/do-or-do-not.jpg"
    width="980px" height="490px"
    loading="lazy"
    class="bleed"
    alt="Do or do not. There is no try. — Yoda («Звёздные войны»)" />
</div>

# О Python

Что произошло: IngvarJackal написал прототип на Python; к началу оценивания
у нас не было работающего бота на Haskell; прототип на Python ушёл в продакшен;
система оценивания заставила меня допиливать то, что *уже* работает, а не то,
что я хочу. Отсюда ирония и картинки с Гарольдом.

Сам я надеюсь больше никогда не повторять этот опыт, но хотел бы записать одну
мысль для команд, использующих Python в качестве основного языка на ICFPC.
Вероятно, мысль можно расширить на любой интерпретируемый язык.

В этом году задача подразумевала отправку кода на сервер организаторов, где он
проходил тестирование и отправлялся в бой с сабмишенами других команд. Это очень
важный момент: он напрямую влияет на длительность цикла отладки. Опечатки
и ошибки типов, не пойманные локально, будут стоить вам около пяти минут
*каждая*: примерно столько времени в этом году проходило между моим пушем
и появлением на сайте лога с тестовым прогоном кода.

Если бы мы решали какую-то оффлайновую задачу (например, [про
оригами][origami]), расклад был бы совершенно другим: опечатки можно было бы
поймать за считанные секунды, и Python (по этому критерию) оказался бы наравне
с компилируемыми языками. Но *в этом году* расклад был неудачным, и мы потеряли
много времени и нервов. Да что там: оба кандидата на финальный сабмишен были
забракованы именно из-за банальной ошибки с именами.

Урок (как мне кажется) в том, что Python нужно либо плотненько обкладывать
тестами, либо же ограничивать его применение вещами, которые можно полностью
проверить локально. Вместо тестов могут сгодиться type hints, mypy и ещё
какие-нибудь чекеры и линтеры, но в этом я уверен чуть меньше.

<hr/>

На этом всё. Наш код можно найти [на GitHub][repo]. Команда в этом году была
настолько большой, что за всеми не уследишь, так что в дополнение к моему отчёту
поглядите ещё и на [мысли Форневера][fvnever-report]. Надеюсь, позже в README
репозитория появятся ссылки и на другие отчёты.

Надеюсь увидеть тебя, дорогой читатель, и твою команду в лидерборде ICFPC 2021
;)

[icfpc-2020-part-1]: /posts/2020-07-22-icfpc-2020-part-1.html
    "ICFPC 2020: предисловие — Debiania"

[icfpc-2020-part-2]: /posts/2020-07-22-icfpc-2020-part-2.html
    "ICFPC 2020: день первый — Debiania"

[icfpc-2020-part-3]: /posts/2020-07-23-icfpc-2020-part-3.html
    "ICFPC 2020: день второй — Debiania"

[icfpc-2020-part-4]: /posts/2020-07-24-icfpc-2020-part-4.html
    "ICFPC 2020: день третий — Debiania"

[icfpc-2020-part-5]: /posts/2020-07-25-icfpc-2020-part-5.html
    "ICFPC 2020: день четвёртый — Debiania"

[pre-final-scoreboard]: https://icfpcontest2020.github.io/#/scoreboard#final
    "ICFP Programming Contest 2020 — Pre-Final Scoreboard"

[rules]: https://icfpcontest2020.github.io/#/rules
    "ICFP Programming Contest 2020 — Contest Rules"

[^1]: Да, их кто-то читает. Да, [я зануда](/tags/EULA.html).

[how-to-win]: https://icfpcontest2020.github.io/#/post/2056
    "How to Actually Win the Contest — Blog — ICFP Programming Contest 2020"

[protocol]: https://icfpcontest2020.github.io/#/post/2059
    "Relatively Fresh News From the World of Reverse-Engineering — Blog — ICFP
    Programming Contest 2020"

[fvnever-report]: https://fornever.me/ru/posts/2020-07-26.icfpc-2020-report.html
    "Отчёт об ICFP Contest 2020 — F. von Never"

[origami]: /posts/2016-08-08-icfpc-2016.html
    "ICFPC 2016 — Debiania"

[repo]: https://github.com/codingteam/icfpc-2020
    "codingteam/icfpc-2020 — GitHub"
